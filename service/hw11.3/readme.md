Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры. Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

# Задача 1: Обеспечить разработку

Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка. 
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

Облачная система;
Система контроля версий Git;
Репозиторий на каждый сервис;
Запуск сборки по событию из системы контроля версий;
Запуск сборки по кнопке с указанием параметров;
Возможность привязать настройки к каждой сборке;
Возможность создания шаблонов для различных конфигураций сборок;
Возможность безопасного хранения секретных данных: пароли, ключи доступа;
Несколько конфигураций для сборки из одного репозитория;
Кастомные шаги при сборке;
Собственные докер образы для сборки проектов;
Возможность развернуть агентов сборки на собственных серверах;
Возможность параллельного запуска нескольких сборок;
Возможность параллельного запуска тестов;
Обоснуйте свой выбор.

### Ответ

1.  В качестве хранения кода предпочту выбрать бесплатный Gitlab.
    *   Gitlab можно развернуть на своих северах.
    *   Возможно создавать разные репозитории для проектов, разделять проекты на группы и настраивать доступ к проектам разного уровня.
    
2. Для запуска pipeline можно использовать бесплатную версию TeamCity.
   TeamCity простой и многофункциональный инструмент для запуска CI/CD процессов.
   Соответствует заявленным требованиям по конфигурациям.

3. TeamCity легко интегрируется с Nexus. Nexus буду использовать для хранения артефактов сборки и версионирования артефактов.
4. Для хранения докер образов можно развернуть собственное хранилище контейнеров. 
   Так же возможно использовать https://hub.docker.com/ для хранения докер образов.

#Задача 2: Логи

Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

Сбор логов в центральное хранилище со всех хостов обслуживающих систему;
Минимальные требования к приложениям, сбор логов из stdout;
Гарантированная доставка логов до центрального хранилища;
Обеспечение поиска и фильтрации по записям логов;
Обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;
Возможность дать ссылку на сохраненный поиск по записям логов;
Обоснуйте свой выбор.

### Ответ

Системные логи и логи приложения можно собирать при помощи ELK (Elasticsearch,Kibana,Logstash,FileBeat).

*   FileBeat - агент, собирающий данные с машины и направляющий в Elasticsearch
*   Logstash - служба обрабатывающая данные: фильтрует, парсит на составляющие поля, агрегирует строки, 
обогащает данные при необходимости и т.п. передает данные в системы потребители при необходимости.
*   Elasticsearch - инструмент аналитики и полнотекстового поиска, позволяет хранить, оперативно получать нужные данные больших объемов
*   Kibana - Web визуальный инструмент для Elasticsearch, позволяет управлять индексами Elasticsearch, 
выполнять непосредственный визуальный поиск, строить Dashbord-ы для удобства оперативного анализа логов(данных).
    
*Логи приложения также можно собирать при помощи Sentry.io или развернутой на собственных мощностях версии.

# Задача 3: Мониторинг

Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

Сбор метрик со всех хостов, обслуживающих систему;
Сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;
Сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;
Сбор метрик, специфичных для каждого сервиса;
Пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;
Пользовательский интерфейс с возможность настраивать различные панели для отслеживания состояния системы;
Обоснуйте свой выбор.

### Ответ

Для мониторинга системных и бизнес параметром буду использовать Prometheus + Grafana. 

*   Prometheus - инструмент для мониторинга и оповещения систем с открытым исходным кодом,
    собирает и хранит метрики в различном виде.
*   Grafana - веб-интерфейс для работы с данными, строит на оперативных данных дашборды. 
    Позволяет визуализировать данные из большинства источников данных, интегрируется с Elasticsearch, 
    который рекомендован в задаче 2, для хранения логов, создавая очень удобный комплекс.
    
# Задача 4: Логи * (необязательная)

Добавить в систему сервисы для сбора логов Vector + ElasticSearch + Kibana со всех сервисов обеспечивающих работу API.
Не получилось разобраться с Vector, нужно больше времени.
 
# Задача 5: Мониторинг * (необязательная)

prometheus + grafana добавлены в docker-compose, метрики настрою чуть позже

Продолжить работу по задаче API Gateway: сервисы используемые в задаче предоставляют набор метрик в формате prometheus:
[docker compose](docker-compose.yaml) файл запустив, который можно перейти по адресу http://localhost:8081 
по которому доступна Grafana с настроенным Dashboard. Логин в Grafana должен быть admin пароль admin